<div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50" (click)="onCancel()">
  <div
    class="w-full max-w-md rounded-2xl bg-[hsl(var(--card))] shadow-(--shadow-warm-lg) border border-[hsl(var(--border))]"
    (click)="$event.stopPropagation()"
    role="dialog"
    aria-modal="true"
    aria-labelledby="modal-title"
  >
    <div class="flex items-center justify-between p-6 border-b border-[hsl(var(--border))]">
      <h2 id="modal-title" class="font-serif text-xl font-bold text-[hsl(var(--foreground))]">
        {{ modalTitle }}
      </h2>
      <button
        type="button"
        (click)="onCancel()"
        class="p-2 rounded-full hover:bg-[hsl(var(--muted))] transition-colors cursor-pointer text-[hsl(var(--muted-foreground))] hover:text-[hsl(var(--foreground))]"
        aria-label="Close"
      >
        <i class="fas fa-times text-lg"></i>
      </button>
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="p-6 space-y-4">
      <div>
        <label for="title" class="block text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider mb-1.5">
          Product Name
        </label>
        <input
          id="title"
          type="text"
          formControlName="title"
          placeholder="e.g. Organic Avocados"
          class="w-full px-3 py-2 rounded-lg border bg-[hsl(var(--secondary))] text-[hsl(var(--foreground))] placeholder:text-[hsl(var(--muted-foreground))] focus:outline-none focus:ring-2 focus:ring-[hsl(var(--ring))]"
          [class.border-[hsl(var(--primary))]]="form.get('title')?.touched && form.get('title')?.invalid"
          [class.border-[hsl(var(--border))]]="!(form.get('title')?.touched && form.get('title')?.invalid)"
        />
        @if (form.get('title')?.touched && form.get('title')?.errors?.['required']) {
          <p class="mt-1 text-xs" style="color: hsl(var(--destructive))">Product name is required</p>
        }
      </div>

      <div>
        <label for="price" class="block text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider mb-1.5">
          Price ($)
        </label>
        <input
          id="price"
          type="number"
          formControlName="price"
          min="0"
          step="0.01"
          placeholder="0.00"
          class="w-full px-3 py-2 rounded-lg border bg-[hsl(var(--secondary))] text-[hsl(var(--foreground))] placeholder:text-[hsl(var(--muted-foreground))] focus:outline-none focus:ring-2 focus:ring-[hsl(var(--ring))] border-[hsl(var(--border))]"
        />
        @if (form.get('price')?.touched && form.get('price')?.errors?.['required']) {
          <p class="mt-1 text-xs" style="color: hsl(var(--destructive))">Price is required</p>
        }
        @if (form.get('price')?.touched && form.get('price')?.errors?.['min']) {
          <p class="mt-1 text-xs" style="color: hsl(var(--destructive))">Price must be 0 or greater</p>
        }
      </div>

      <div>
        <label for="unit" class="block text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider mb-1.5">
          Weight / Size
        </label>
        <input
          id="unit"
          type="text"
          formControlName="unit"
          placeholder="e.g. 500g"
          class="w-full px-3 py-2 rounded-lg border bg-[hsl(var(--secondary))] text-[hsl(var(--foreground))] placeholder:text-[hsl(var(--muted-foreground))] focus:outline-none focus:ring-2 focus:ring-[hsl(var(--ring))] border-[hsl(var(--border))]"
        />
      </div>

      <div>
        <label for="image" class="block text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider mb-1.5">
          Image URL
        </label>
        <input
          id="image"
          type="url"
          formControlName="image"
          placeholder="https://example.com/image.jpg"
          class="w-full px-3 py-2 rounded-lg border bg-[hsl(var(--secondary))] text-[hsl(var(--foreground))] placeholder:text-[hsl(var(--muted-foreground))] focus:outline-none focus:ring-2 focus:ring-[hsl(var(--ring))] border-[hsl(var(--border))]"
        />
        @if (form.get('image')?.touched && form.get('image')?.value && form.get('image')?.errors?.['pattern']) {
          <p class="mt-1 text-xs" style="color: hsl(var(--destructive))">Please enter a valid URL (e.g. https://...)</p>
        }
      </div>

      <div>
        <label for="category" class="block text-xs font-medium text-[hsl(var(--muted-foreground))] uppercase tracking-wider mb-1.5">
          Category
        </label>
        <select
          id="category"
          formControlName="category"
          class="w-full px-3 py-2 rounded-lg border bg-[hsl(var(--secondary))] text-[hsl(var(--foreground))] focus:outline-none focus:ring-2 focus:ring-[hsl(var(--ring))] border-[hsl(var(--border))]"
        >
          <option value="">Select category</option>
          @for (cat of categories(); track cat._id) {
            <option [value]="cat._id">{{ cat.name }}</option>
          }
        </select>
        @if (form.get('category')?.touched && form.get('category')?.errors?.['required']) {
          <p class="mt-1 text-xs" style="color: hsl(var(--destructive))">Category is required</p>
        }
      </div>

      <div class="flex items-start gap-3">
        <input
          id="featured"
          type="checkbox"
          formControlName="featured"
          class="mt-1 w-4 h-4 rounded border-[hsl(var(--border))] text-[hsl(var(--primary))] focus:ring-[hsl(var(--ring))] cursor-pointer"
        />
        <div>
          <label for="featured" class="font-medium text-[hsl(var(--foreground))] cursor-pointer">Featured Product</label>
          <p class="text-xs text-[hsl(var(--muted-foreground))] mt-0.5">Display prominently on the homepage</p>
        </div>
      </div>

      <div class="flex gap-3 pt-4">
        <button
          type="button"
          (click)="onCancel()"
          class="flex-1 px-4 py-2.5 rounded-xl border border-[hsl(var(--border))] bg-[hsl(var(--secondary))] text-[hsl(var(--foreground))] font-medium hover:bg-[hsl(var(--muted))] transition-colors cursor-pointer"
        >
          Cancel
        </button>
        <button
          type="submit"
          class="flex-1 px-4 py-2.5 rounded-xl bg-[hsl(var(--accent))] text-[hsl(var(--accent-foreground))] font-medium hover:bg-[hsl(var(--terracotta-light))] transition-colors cursor-pointer"
        >
          {{ submitLabel }}
        </button>
      </div>
    </form>
  </div>
</div>
