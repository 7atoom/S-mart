<div class="categories-sec mt-16 py-16 px-6 bg-page text-foreground">
  <div class="container mx-auto 2xl:w-[85%]">
    <div class="top-part flex items-center justify-between mb-12">
      <h2 class="font-serif text-3xl md:text-5xl font-bold">Shop by Category</h2>
      <a (click)="navigateToCategory('All')"
         class="text-sm font-medium hover:underline cursor-pointer"
         style="color: hsl(var(--accent))">
        View all &rightarrow;
      </a>
    </div>

    @if (isLoading()) {
      <!-- Skeleton grid -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 auto-rows-[250px] lg:auto-rows-[300px]">
        @for (item of [1, 2]; track item) {
          <div class="lg:row-span-2 rounded-3xl overflow-hidden animate-pulse h-full"
               style="background-color: hsl(var(--muted))">
            <div class="w-full h-full" style="background-color: hsl(var(--border))"></div>
          </div>
        }
        @for (item of [3, 4, 5, 6]; track item) {
          <div class="rounded-3xl overflow-hidden animate-pulse h-full"
               style="background-color: hsl(var(--muted))">
            <div class="w-full h-full" style="background-color: hsl(var(--border))"></div>
          </div>
        }
      </div>

    } @else if (isError()) {
      <!-- Error state -->
      <div class="flex flex-col items-center justify-center py-20 gap-4 text-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-14 h-14" fill="none" viewBox="0 0 24 24" stroke="currentColor"
             style="color: hsl(var(--destructive))">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                d="M12 9v4m0 4h.01M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
        </svg>
        <p class="text-lg font-semibold" style="color: hsl(var(--foreground))">Failed to load categories</p>
        <p class="text-sm" style="color: hsl(var(--muted-foreground))">Something went wrong. Please try again.</p>
        <button (click)="retry()"
                class="mt-2 px-6 py-2 rounded-full text-sm font-medium transition-opacity hover:opacity-90 btn-accent cursor-pointer">
          Retry
        </button>
      </div>

    } @else {
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 auto-rows-[250px] lg:auto-rows-[300px]">
        @for (category of categories().slice(1); track category._id; let i = $index) {
          <a (click)="navigateToCategory(category.name)"
             class="group cursor-pointer"
             [class.lg:row-span-2]="i < 2">
            <div class="relative rounded-3xl overflow-hidden h-full warm-shadow"
                 style="background-color: hsl(var(--muted))">
              <img [src]="category.image" [alt]="category.name"
                   class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300">
              <div class="absolute inset-0 bg-linear-to-t from-black/60 to-transparent"></div>
              <div class="absolute bottom-0 left-0 p-6">
                <h3 class="font-semibold" style="color: hsl(var(--primary-foreground))"
                    [class.text-2xl]="i < 2" [class.text-xl]="i >= 2">
                  {{ category.name }}
                </h3>
              </div>
            </div>
          </a>
        }
      </div>
    }
  </div>
</div>
